# --- Vi mode ---
set -g mode-keys vi
set -g status-keys vi

# Vi-style copy mode
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection-and-cancel

# --- Seamless vim/tmux navigation (Ctrl-h/j/k/l) ---
# Works with christoomey/vim-tmux-navigator
is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
    | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|l?n?vim?x?|fzf)(diff)?$'"

bind -n C-h if-shell "$is_vim" 'send-keys C-h' 'select-pane -L'
bind -n C-j if-shell "$is_vim" 'send-keys C-j' 'select-pane -D'
bind -n C-k if-shell "$is_vim" 'send-keys C-k' 'select-pane -U'
bind -n C-l if-shell "$is_vim" 'send-keys C-l' 'select-pane -R'
bind -n C-\\ if-shell "$is_vim" 'send-keys C-\\' 'select-pane -l'

# Restore these bindings in copy-mode too
bind -T copy-mode-vi C-h select-pane -L
bind -T copy-mode-vi C-j select-pane -D
bind -T copy-mode-vi C-k select-pane -U
bind -T copy-mode-vi C-l select-pane -R
bind -T copy-mode-vi C-\\ select-pane -l

# --- Pane splitting (vim-style) ---
bind v split-window -h -c "#{pane_path}"
bind s split-window -v -c "#{pane_path}"

# --- Pane movement (swap in direction, no prefix needed) ---
# Alt+Shift+h/j/k/l to swap pane in that direction
bind -n M-H swap-pane -t '{left-of}'
bind -n M-J swap-pane -t '{down-of}'
bind -n M-K swap-pane -t '{up-of}'
bind -n M-L swap-pane -t '{right-of}'

# --- Pane identification ---
set -g pane-border-status top
set -g pane-border-format " #{?pane_active,#[fg=colour39 bold],#[fg=colour245]}#{pane_index}: #{pane_title}#[default] "
set -g pane-border-style fg=colour240
set -g pane-active-border-style fg=colour39

# --- Pane opacity (active = fully opaque, inactive = dimmed) ---
set -g window-style 'fg=colour247'
set -g window-active-style 'fg=terminal'

# --- Quality of life ---
set -g escape-time 0
set -g base-index 1
setw -g pane-base-index 1
